name: Compilar APK desde ZIP
on:
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: 1. Descargar repositorio
        uses: actions/checkout@v4

      - name: 2. Descomprimir archivos
        run: |
          unzip CursorOverlay.zip
          # Esto mueve los archivos fuera si estaban dentro de una carpeta
          cp -r CursorOverlay/* . || true 

      - name: 3. Configurar Java
        uses: actions/setup-java@v4
        with:
          java-version: '17'
          distribution: 'temurin'
          cache: gradle

      - name: 4. Corregir permisos de Gradle
        run: |
          # Si no existe el ejecutable, lo creamos
          if [ ! -f gradlew ]; then gradle wrapper; fi
          chmod +x gradlew

      - name: 5. Compilar APK
        run: ./gradlew assembleDebug

      - name: 6. Subir APK final
        uses: actions/upload-artifact@v4
        with:
          name: App-Instalable
          path: "**/build/outputs/apk/debug/*.apk"
