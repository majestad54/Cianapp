name: Compilar APK Final
on:
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: 1. Descargar Repositorio
        uses: actions/checkout@v4

      - name: 2. Descomprimir y Organizar
        run: |
          unzip CursorOverlay.zip
          PROYECTO_DIR=$(find . -name "build.gradle" -exec dirname {} + | head -n 1)
          echo "DIR_PATH=$PROYECTO_DIR" >> $GITHUB_ENV

      - name: 3. Configurar Java 11 (Versi√≥n Compatible)
        uses: actions/setup-java@v4
        with:
          java-version: '11'
          distribution: 'temurin'
          cache: gradle

      - name: 4. Compilar APK con Limpieza
        run: |
          cd ${{ env.DIR_PATH }}
          if [ ! -f gradlew ]; then gradle wrapper; fi
          chmod +x gradlew
          ./gradlew clean assembleDebug

      - name: 5. Entregar APK
        uses: actions/upload-artifact@v4
        with:
          name: CursorOverlay-Instalable
          path: "**/*.apk"
